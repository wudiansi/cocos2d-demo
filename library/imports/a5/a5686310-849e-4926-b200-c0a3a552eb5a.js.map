{"version":3,"sources":["assets\\scripts\\Player.js"],"names":["Sprite","cc","Class","name","Component","properties","jumpHeight","jumpDuration","maxMoveSpeed","accel","jumpAudio","type","AudioClip","runJumpAction","jumpUp","tween","by","y","easing","jumpDown","sequence","call","playJumpSound","repeatForever","audioEngine","playEffect","onKeyDown","event","keyCode","macro","KEY","a","accLeft","d","accRight","onKeyUp","onLoad","jumpAction","node","then","start","xSpeed","systemEvent","on","SystemEvent","EventType","KEY_DOWN","KEY_UP","onDestroy","off","update","dt","Math","abs","x"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA,IAAIA,MAAM,GAAGC,EAAE,CAACC,KAAH,CAAS;AAClBC,EAAAA,IAAI,EAAE;AADY,CAAT,CAAb;AAIAF,EAAE,CAACC,KAAH,CAAS;AACL,aAASD,EAAE,CAACG,SADP;AAGLC,EAAAA,UAAU,EAAE;AACR;AACAC,IAAAA,UAAU,EAAE,CAFJ;AAGR;AACAC,IAAAA,YAAY,EAAE,CAJN;AAKR;AACAC,IAAAA,YAAY,EAAE,CANN;AAOR;AACAC,IAAAA,KAAK,EAAE,CARC;AASR;AACAC,IAAAA,SAAS,EAAE;AACP,iBAAS,IADF;AAEPC,MAAAA,IAAI,EAAEV,EAAE,CAACW;AAFF,KAVH,CAcR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AA5BQ,GAHP;AAkCLC,EAAAA,aAlCK,2BAkCW;AACZ;AACA,QAAIC,MAAM,GAAGb,EAAE,CAACc,KAAH,GAAWC,EAAX,CAAc,KAAKT,YAAnB,EAAiC;AAAEU,MAAAA,CAAC,EAAE,KAAKX;AAAV,KAAjC,EAAyD;AAAEY,MAAAA,MAAM,EAAE;AAAV,KAAzD,CAAb,CAFY,CAIZ;;AACA,QAAIC,QAAQ,GAAGlB,EAAE,CAACc,KAAH,GAAWC,EAAX,CAAc,KAAKT,YAAnB,EAAiC;AAAEU,MAAAA,CAAC,EAAE,CAAC,KAAKX;AAAX,KAAjC,EAA0D;AAAEY,MAAAA,MAAM,EAAE;AAAV,KAA1D,CAAf,CALY,CAOZ;;AACA,QAAIH,KAAK,GAAGd,EAAE,CAACc,KAAH,GACCK,QADD,CACUN,MADV,EACkBK,QADlB,EAEA;AAFA,KAGCE,IAHD,CAGM,KAAKC,aAHX,EAG0B,IAH1B,CAAZ,CARY,CAaZ;;AACA,WAAOrB,EAAE,CAACc,KAAH,GAAWQ,aAAX,CAAyBR,KAAzB,CAAP;AAEH,GAlDI;AAoDLO,EAAAA,aApDK,2BAoDW;AACZrB,IAAAA,EAAE,CAACuB,WAAH,CAAeC,UAAf,CAA0B,KAAKf,SAA/B,EAA0C,KAA1C;AACH,GAtDI;AAwDL;AACAgB,EAAAA,SAzDK,qBAyDKC,KAzDL,EAyDY;AACb,YAAQA,KAAK,CAACC,OAAd;AACI,WAAK3B,EAAE,CAAC4B,KAAH,CAASC,GAAT,CAAaC,CAAlB;AACI,aAAKC,OAAL,GAAe,IAAf;AACA;;AACJ,WAAK/B,EAAE,CAAC4B,KAAH,CAASC,GAAT,CAAaG,CAAlB;AACI,aAAKC,QAAL,GAAgB,IAAhB;AACA;;AACJ;AACI;AARR;AAUH,GApEI;AAsELC,EAAAA,OAtEK,mBAsEGR,KAtEH,EAsEU;AACX,YAAQA,KAAK,CAACC,OAAd;AACI,WAAK3B,EAAE,CAAC4B,KAAH,CAASC,GAAT,CAAaC,CAAlB;AACI,aAAKC,OAAL,GAAe,KAAf;AACA;;AACJ,WAAK/B,EAAE,CAAC4B,KAAH,CAASC,GAAT,CAAaG,CAAlB;AACI,aAAKC,QAAL,GAAgB,KAAhB;AACA;;AACJ;AACI;AARR;AAUH,GAjFI;AAmFL;AAEAE,EAAAA,MArFK,oBAqFK;AACN;AACA,QAAIC,UAAU,GAAG,KAAKxB,aAAL,EAAjB;AACAZ,IAAAA,EAAE,CAACc,KAAH,CAAS,KAAKuB,IAAd,EAAoBC,IAApB,CAAyBF,UAAzB,EAAqCG,KAArC,GAHM,CAKN;;AACA,SAAKR,OAAL,GAAe,KAAf;AACA,SAAKE,QAAL,GAAgB,KAAhB,CAPM,CAQN;;AACA,SAAKO,MAAL,GAAc,CAAd,CATM,CAWN;;AACAxC,IAAAA,EAAE,CAACyC,WAAH,CAAeC,EAAf,CAAkB1C,EAAE,CAAC2C,WAAH,CAAeC,SAAf,CAAyBC,QAA3C,EAAqD,KAAKpB,SAA1D,EAAqE,IAArE;AACAzB,IAAAA,EAAE,CAACyC,WAAH,CAAeC,EAAf,CAAkB1C,EAAE,CAAC2C,WAAH,CAAeC,SAAf,CAAyBE,MAA3C,EAAmD,KAAKZ,OAAxD,EAAiE,IAAjE;AACH,GAnGI;AAqGLa,EAAAA,SArGK,uBAqGO;AACR;AACA/C,IAAAA,EAAE,CAACyC,WAAH,CAAeO,GAAf,CAAmBhD,EAAE,CAAC2C,WAAH,CAAeC,SAAf,CAAyBC,QAA5C,EAAsD,KAAKpB,SAA3D,EAAsE,IAAtE;AACAzB,IAAAA,EAAE,CAACyC,WAAH,CAAeO,GAAf,CAAmBhD,EAAE,CAAC2C,WAAH,CAAeC,SAAf,CAAyBE,MAA5C,EAAoD,KAAKZ,OAAzD,EAAkE,IAAlE;AACH,GAzGI;AA2GLK,EAAAA,KA3GK,mBA2GG,CAEP,CA7GI;AA+GLU,EAAAA,MA/GK,kBA+GGC,EA/GH,EA+GO;AACR;AACA,QAAG,KAAKnB,OAAR,EAAiB;AACb,WAAKS,MAAL,IAAe,KAAKhC,KAAL,GAAa0C,EAA5B;AACH;;AAED,QAAG,KAAKjB,QAAR,EAAkB;AACd,WAAKO,MAAL,IAAe,KAAKhC,KAAL,GAAa0C,EAA5B;AACH;;AAED,QAAGC,IAAI,CAACC,GAAL,CAAS,KAAKZ,MAAd,IAAwB,KAAKjC,YAAhC,EAA8C;AAC1C;AACA,WAAKiC,MAAL,GAAc,KAAKjC,YAAL,GAAoB,KAAKiC,MAAzB,GAAkCW,IAAI,CAACC,GAAL,CAAS,KAAKZ,MAAd,CAAhD;AACH;;AAED,SAAKH,IAAL,CAAUgB,CAAV,IAAe,KAAKb,MAAL,GAAcU,EAA7B;AACH;AA/HI,CAAT","sourceRoot":"/","sourcesContent":["// Learn cc.Class:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\nlet Sprite = cc.Class({\r\n    name: \"sprite\"\r\n})\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // 跳跃高度\r\n        jumpHeight: 0,\r\n        // 跳跃持续时间\r\n        jumpDuration: 0,\r\n        // 最大移动速度\r\n        maxMoveSpeed: 0,\r\n        // 加速度\r\n        accel: 0,\r\n        // 跳跃音效\r\n        jumpAudio: {\r\n            default: null,\r\n            type: cc.AudioClip\r\n        },\r\n        // foo: {\r\n        //     // ATTRIBUTES:\r\n        //     default: null,        // The default value will be used only when the component attaching\r\n        //                           // to a node for the first time\r\n        //     type: cc.SpriteFrame, // optional, default is typeof default\r\n        //     serializable: true,   // optional, default is true\r\n        // },\r\n        // bar: {\r\n        //     get () {\r\n        //         return this._bar;\r\n        //     },\r\n        //     set (value) {\r\n        //         this._bar = value;\r\n        //     }\r\n        // },\r\n    },\r\n\r\n    runJumpAction() {\r\n        // 跳跃上升\r\n        let jumpUp = cc.tween().by(this.jumpDuration, { y: this.jumpHeight }, { easing: 'easeOut' });\r\n\r\n        // 跳跃下降\r\n        let jumpDown = cc.tween().by(this.jumpDuration, { y: -this.jumpHeight }, { easing: 'easeIn' });\r\n\r\n        // 创建一个缓动 按照跳跃 下降的顺序执行\r\n        let tween = cc.tween()\r\n                    .sequence(jumpUp, jumpDown)\r\n                    // 添加一个回调函数， 在前面的动作都结束时调用我们定义的playJumpSound方法播放音效\r\n                    .call(this.playJumpSound, this);\r\n\r\n        // 不断重复\r\n        return cc.tween().repeatForever(tween);\r\n\r\n    },\r\n\r\n    playJumpSound() {\r\n        cc.audioEngine.playEffect(this.jumpAudio, false)\r\n    },\r\n\r\n    // 键入\r\n    onKeyDown(event) {\r\n        switch (event.keyCode) {\r\n            case cc.macro.KEY.a:\r\n                this.accLeft = true\r\n                break;\r\n            case cc.macro.KEY.d:\r\n                this.accRight = true\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    },\r\n\r\n    onKeyUp(event) {\r\n        switch (event.keyCode) {\r\n            case cc.macro.KEY.a:\r\n                this.accLeft = false\r\n                break;\r\n            case cc.macro.KEY.d:\r\n                this.accRight = false\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        // 初始无限跳跃\r\n        let jumpAction = this.runJumpAction();\r\n        cc.tween(this.node).then(jumpAction).start();\r\n\r\n        // 加速度开关\r\n        this.accLeft = false\r\n        this.accRight = false\r\n        // 水平方向位移\r\n        this.xSpeed = 0\r\n\r\n        // 监听键盘\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this)\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this)\r\n    },\r\n\r\n    onDestroy() {\r\n        // 取消键盘监听\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this)\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this)\r\n    },\r\n\r\n    start() {\r\n        \r\n    },\r\n\r\n    update (dt) {\r\n        // 根据当前加速度方向更新每帧速度\r\n        if(this.accLeft) {\r\n            this.xSpeed -= this.accel * dt\r\n        }\r\n\r\n        if(this.accRight) {\r\n            this.xSpeed += this.accel * dt\r\n        }\r\n\r\n        if(Math.abs(this.xSpeed) > this.maxMoveSpeed) {\r\n            // 超过最大速度\r\n            this.xSpeed = this.maxMoveSpeed * this.xSpeed / Math.abs(this.xSpeed)\r\n        }\r\n\r\n        this.node.x += this.xSpeed * dt\r\n    },\r\n});\r\n"]}